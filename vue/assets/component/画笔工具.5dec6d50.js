import{_ as t}from"../index.56e2a9af.js";import{k as i,v as e,x as s,F as a,B as h,C as n,D as o,P as r,G as d}from"../@vue/@vue.a9907412.js";import"../vue-router/vue-router.30f59dce.js";import"../pinia/pinia.2d6c69fe.js";import"../vue-demi/vue-demi.784001c0.js";import"../shaonq/shaonq.e47bfeb9.js";import"../vite-plugin-mock/vite-plugin-mock.5f58db78.js";import"../mockjs/mockjs.69e5819b.js";import"../path-to-regexp/path-to-regexp.dea237f3.js";
/*!https://github.com/dulnan/lazy-brush is licensed under the MIT License */class c{constructor(t,i){this.x=t,this.y=i}}class l extends c{update(t){this.x=t.x,this.y=t.y}moveByAngle(t,i){const e=t+Math.PI/2;this.x=this.x+Math.sin(e)*i,this.y=this.y-Math.cos(e)*i}equalsTo(t){return this.x===t.x&&this.y===t.y}getDifferenceTo(t){return new c(this.x-t.x,this.y-t.y)}getDistanceTo(t){const i=this.getDifferenceTo(t);return Math.sqrt(Math.pow(i.x,2)+Math.pow(i.y,2))}getAngleTo(t){const i=this.getDifferenceTo(t);return Math.atan2(i.y,i.x)}toObject(){return{x:this.x,y:this.y}}}class u{constructor({radius:t=30,enabled:i=!0,initialPoint:e={x:0,y:0}}={}){this.radius=t,this._isEnabled=i,this.pointer=new l(e.x,e.y),this.brush=new l(e.x,e.y),this.angle=0,this.distance=0,this._hasMoved=!1}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}isEnabled(){return this._isEnabled}setRadius(t){this.radius=t}getRadius(){return this.radius}getBrushCoordinates(){return this.brush.toObject()}getPointerCoordinates(){return this.pointer.toObject()}getBrush(){return this.brush}getPointer(){return this.pointer}getAngle(){return this.angle}getDistance(){return this.distance}brushHasMoved(){return this._hasMoved}update(t,{both:i=!1}={}){return this._hasMoved=!1,!(this.pointer.equalsTo(t)&&!i)&&(this.pointer.update(t),i?(this._hasMoved=!0,this.brush.update(t),!0):(this._isEnabled?(this.distance=this.pointer.getDistanceTo(this.brush),this.angle=this.pointer.getAngleTo(this.brush),this.distance>this.radius&&(this.brush.moveByAngle(this.angle,this.distance-this.radius),this._hasMoved=!0)):(this.distance=0,this.angle=0,this.brush.update(t),this._hasMoved=!0),!0))}}class g{constructor({canvas:t,width:i=t.scrollWidth,height:e=t.scrollHeight,color:s="#fc4639",backgroundImage:a,lineWidth:h}){this.isStart=!1,this.canvas=t,this.setColor(s);const n=this.ctx=t.getContext("2d");this.backgroundImage=a,this.setArea({width:i,height:e}),this.setLineWidth(h),this.clearCanvas();const o=(t,i)=>({x:t.x+(i.x-t.x)/2,y:t.y+(i.y-t.y)/2}),r=[],d=new u({radius:5,enabled:!0,initialPoint:{x:0,y:0}}),c=(t,i)=>{t=this.dpiSize(t),i=this.dpiSize(i);const e=d.update({x:t,y:i}),s=!d.isEnabled();if((e||s)&&r.push(d.brush.toObject()),d.brushHasMoved()||s){this.clearCanvas(),this.putImgData(this.tempImgData),r.push(d.brush.toObject());let t=r[0],i=r[1];n.moveTo(i.x,i.y),n.beginPath();for(let e=1,s=r.length;e<s;e++){const s=o(t,i);n.quadraticCurveTo(t.x,t.y,s.x,s.y),t=r[e],i=r[e+1]}n.lineTo(t.x,t.y),n.stroke()}},l=this.isMobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),[g,p,b]=[l?"touchmove":"mousemove",l?"touchstart":"mousedown",l?"touchend":"mouseup"];t.addEventListener(g,(t=>{let{offsetX:i,offsetY:e}=t;if(l){const{clientX:s,clientY:a}=t.changedTouches[0],{top:h,left:n}=t.target.getBoundingClientRect();i=s-n,e=a-h}this.isStart&&(c(i,e),t.preventDefault())}),!1),document.addEventListener(p,(t=>{this.isStart=!0,n.beginPath(),n.strokeStyle=this.color,n.lineCap="round",n.lineJoin="round",n.lineWidth=Number((this.lineWidth/this.dpi).toFixed(2))}),!1),document.addEventListener(b,(()=>{this.isStart=!1,r.length=0,this.tempImgData=n.getImageData(0,0,t.width,t.height)}),!1)}dpiSize(t){return t/this.dpi*this.ratio}setColor(t){this.color=t}setArea({width:t,height:i}){this.dpi=window.innerWidth>1024?1:window.devicePixelRatio;const e=this.canvas;e.width=t,e.height=i,this.ratio=Number(t/e.offsetWidth),e.style.width=e.offsetWidth+"px",e.style.height=e.offsetHeight+"px",this.ctx.scale(this.dpi,this.dpi)}setLineWidth(t=3){this.lineWidth=t}clearCanvas(t){if(t&&(this.tempImgData=null),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.backgroundImage){const t=this.canvas.width/this.backgroundImage.width;this.backgroundImage&&this.ctx.drawImage(this.backgroundImage,0,0,this.backgroundImage.width*t,this.backgroundImage.height*t)}}putImgData(t){t&&this.ctx.putImageData(t,0,0)}exportPNG(t=.91){return canvas.toDataURL("image/png",t)}}const p={data:()=>({colors:["#212121","#2463fe","#57c860","#f5cb37","#fc4639"],colorsIndex:0}),mounted(){this.dataInit()},methods:{dataInit(){const t=this.$refs.canvas;this.hb=new g({canvas:t}),this.setColorIndex(this.colors.length-1)},setColorIndex(t=0){this.colorsIndex=t,this.hb.setColor(this.colors[t])}}},b=t=>(n("data-v-b8f4ef6e"),t=t(),o(),t),v={class:"u-card"},m={class:"u-card__hd"},x=b((()=>s("cite",{class:"u-card__title u-flex__item"},"画笔工具",-1))),f=[b((()=>s("svg",{t:"1633922835611",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5534",width:"32",height:"32"},[s("path",{d:"M584.7 768.3L246.2 429.8 577.6 98.5c3.9-3.9 10.2-3.9 14.1 0L916 422.8c3.9 3.9 3.9 10.2 0 14.1L584.7 768.3z",fill:"#51B5ED","p-id":"5535"}),s("path",{d:"M880.8 387.5L821 327.7c23.4 23.4 23.4 61.2 0 84.6L524.9 708.5l59.8 59.8 296.1-296.1c23.4-23.4 23.4-61.3 0-84.7z",fill:"#2996D3","p-id":"5536"}),s("path",{d:"M408.4 896.6L117.9 606.1c-3.9-3.9-3.9-10.2 0-14.1l145.2-145.2 304.6 304.6-145.2 145.2c-3.9 3.9-10.2 3.9-14.1 0z",fill:"#E4EFF4","p-id":"5537"}),s("path",{d:"M263.2 446.8L508 691.6l-110 110c-23.4 23.4-61.2 23.4-84.6 0l59.8 59.8c23.4 23.4 61.2 23.4 84.6 0l110-110-304.6-304.6z",fill:"#C1DFEA","p-id":"5538"}),s("path",{d:"M674.3 263.5m-12 0a12 12 0 1 0 24 0 12 12 0 1 0-24 0Z",fill:"#FFFFFF","p-id":"5539"}),s("path",{d:"M449.3 321.3c-3.1 0-6.1-1.2-8.5-3.5-4.7-4.7-4.7-12.2 0-16.9l135.4-135.4c4.5-4.5 12.4-4.5 16.9 0l50.8 50.8c4.7 4.7 4.7 12.2 0 16.9-4.7 4.7-12.2 4.7-16.9 0l-42.3-42.3-126.9 126.9c-2.4 2.3-5.4 3.5-8.5 3.5z",fill:"#FFFFFF","p-id":"5540"})],-1)))],y=["onClick"],w={class:"u-card__bd",style:{padding:"0",background:"rgba(0, 0, 0, 0.01)"}},I={ref:"canvas",style:{height:"600px",width:"100%"}};var M=t(p,[["render",function(t,n,o,c,l,u){return i(),e("div",null,[s("div",v,[s("div",m,[x,s("div",{title:"清除画板",class:"rubber",onClick:n[0]||(n[0]=i=>t.hb.clearCanvas(!0))},f),(i(!0),e(a,null,h(l.colors,((t,s)=>(i(),e("div",{key:s,style:r({background:t,color:t}),class:d([{active:l.colorsIndex===s},"u-ml dot"]),onClick:t=>u.setColorIndex(s)},null,14,y)))),128))]),s("div",w,[s("canvas",I,null,512)])])])}],["__scopeId","data-v-b8f4ef6e"]]);export{M as default};
