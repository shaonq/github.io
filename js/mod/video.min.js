define(function(a){return function(){var container=$(this);var ui='        <!-- jp-gui { S -->\r\n            <div class="jp-gui ">\r\n                <!--  第一次显示，播放之后不显示 -->\r\n            <div class="jp-video-play">\r\n                <button class="jp-video-play-icon" role="button" tabindex="0" >play</button>\r\n                </div>\r\n                <!-- 标题 -->\r\n                <div class="jp-details">\r\n                <div class="jp-title" aria-label="title"></div>\r\n                </div>\r\n                <div class="jp-interface">\r\n                <div class="jp-controls-holder">\r\n                <!--播放/暂停-->\r\n                <a href="javascript:;" class="jp-play" title="播放" tabindex="1">play</a>\r\n                <a href="javascript:;" class="jp-pause" title="暂停" tabindex="1">pause</a>\r\n                <span class="separator sep-1"></span>\r\n                <!-- 播放进度条 -->\r\n                <div class="jp-progress">\r\n                <div class="jp-seek-bar">\r\n                <div class="jp-play-bar"><span></span></div>\r\n                </div>\r\n                </div>\r\n                <!-- 时间通知 -->\r\n                <div class="jp-current-time"></div>\r\n                <span class="time-sep">/</span>\r\n                <div class="jp-duration"></div>\r\n                <span class="separator sep-2"></span>\r\n                <!-- 静音/取消静音 -->\r\n                <a href="javascript:;" class="jp-mute" tabindex="1" title="静音">mute</a>\r\n                <a href="javascript:;" class="jp-unmute" tabindex="1" title="取消静音">unmute</a>\r\n                <!-- 音量条 -->\r\n                <div class="jp-volume-bar">\r\n                <div class="jp-volume-bar-value"><span class="handle"></span></div>\r\n                </div>\r\n                <span class="separator sep-2"></span>\r\n                <!--full screen toggle-->\r\n            <a href="javascript:;" class="jp-full-screen" tabindex="1" title="全屏播放">full screen</a>\r\n            <a href="javascript:;" class="jp-restore-screen" tabindex="1" title="普通模式">restore screen</a>\r\n            </div>\r\n            </div>\r\n            </div>\r\n            <!-- END } -->';container.find("[data-video]").each(function(i){var t=this,that=$(t),parent=that.parent(),title=that.attr("title")||"",video=that.data("video")||{},id="jp_parent_"+i;parent.attr("id",id);that.after(ui);that.jPlayer({ready:function(){$(this).jPlayer("setMedia",{title:title,m4v:video.src,poster:video.img})},cssSelectorAncestor:"#"+id,swfPath:"http://cdn.bootcss.com/jplayer/2.9.2/jplayer/",supplied:"m4v",size:{width:"570px",height:"340px",cssClass:"jp-video-360p"}});if(window.localStorage&&video.id){var videoStorag=function(){var l=localStorage.data_lib_video_storage||"{}";typeof l==="string"&&(l=JSON.parse(l));return l};that.on($.jPlayer.event.timeupdate,function(ev){var l=videoStorag(),t=ev.jPlayer.status.currentTime;if(t){l[video.id]=t;localStorage.data_lib_video_storage=JSON.stringify(l)}}).on($.jPlayer.event.play,function(ev){var historyTimeBox=parent.find(".jp-history-time");if(historyTimeBox.length){historyTimeBox.show();var close=historyTimeBox.find(".jp-history-time-close"),clear=setTimeout(function(){historyTimeBox.remove(),close.off("click")},5e3);historyTimeBox.on("click",function(){historyTimeBox.remove(),close.off("click"),that.jPlayer("play",parseFloat(historyTimeBox.attr("time")))});close.on("click",function(){historyTimeBox.remove(),clearTimeout(clear);return false})}}).on($.jPlayer.event.ended,function(ev){var l=videoStorag();l[video.id]=null;localStorage.data_lib_video_storage=JSON.stringify(l)});var l=videoStorag();if(l[video.id]>5){var time=l[video.id];$('<div class="jp-history-time" time="'+time+'">上次播放时间:'+$.jPlayer.convertTime(time)+'<i class="jp-history-time-close">X</i> </div>').prependTo(parent.find(".jp-gui"))}}})}});