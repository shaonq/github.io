(function(){var e={type:{msg:function(e){var t='<div class="{{d.me}}"> \r\n                            <p>{{d.text}}</p>\r\n                         </div>',i={text:e.text,time:nui.util.date.now(),user:e.user||"你猜我是谁",img:e.img||"http://placeholder.qiniudn.com/40x40/ddd/ddd",me:e.me?"this":""};return nui.tpl(t,i)},zip:function(e){var t='<div class="{{d.me}}" type="zip"> \r\n                            <p><a href="{{d.text}}">下载</a></p>\r\n                         </div>',i={text:e.text,time:nui.util.date.now(),user:e.user||"你猜我是谁",img:e.img||"http://placeholder.qiniudn.com/40x40/ddd/ddd",me:e.me?"this":""};return nui.tpl(t,i)}}};var t=window.nui.chat=function(e){this.box=e.box};t.prototype.escape=function(e){return String(e||"").replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};t.prototype.send=function(t){var i=this.box;if(typeof t==="object"){t.type in e.type?i.append(e.type[t.type](t)):i.append(e.type.msg(t));var n=i[0];nui.animate(n.scrollTop,n.scrollHeight-300,function(e){n.scrollTop=e},"easeOut",1e3)}};if(window.nui){var i='<style>  \r\n            .__c{position:fixed;left:50%;top:50%;width:320px;margin-top:-240px;margin-left:-160px;height:430px;border-radius:0 0 3px 3px;overflow:hidden;box-shadow:0 4px 16px rgba(0,0,0,0.16)}\r\n            .__cc{height:5px;background-color:#f75b43}.__cc:hover{cursor:move}.__cc,.__ch,.__cb{position:relative;width:100%;box-sizing:border-box}\r\n            .__ch{height:340px;overflow-x:hidden;overflow-y:scroll;padding:10px 0 0;background-color:#eee}\r\n            .__cb{height:85px;background-color:#fff}.__ch>div>*{display:none}.__ch>div>p{max-width:280px;padding:9px 13px;background-color:#fff;min-height:1em;display:inline-block;vertical-align:top;position:relative;text-align:left;font-size:13px;border-radius:3px;color:#666;margin:5px 10px;animation:scale-in cubic-bezier(0.22,0.58,0.12,0.98) .5s}\r\n            .__ch>div>p:before{content:" ";position:absolute;top:12px;right:100%;border:6px solid transparent;border-right-color:#fafafa}\r\n            .__ch>div.this>p:before{right:auto;left:100%;border-right-color:transparent;border-left-color:#b2e281}\r\n            .__ch>div.this{text-align:right}.__ch>div.this p{background-color:#b2e281}.__cb a{margin-top:10px;margin-right:10px}\r\n            </style><div class="__c a-move-in-top"> <div class="__cc"></div><div class="__ch"> </div> <div class="__cb"> <div> <textarea class="nui-textarea nui-noborder" placeholder="按 Enter 发送"></textarea> <span  class="fr hide"><a class="nui-btn nui-btn-red" onclick="parentNode.parentNode.parentNode.parentNode.style.display=\'none\'">关闭</a> <a id="submit" class="nui-btn nui-btn-default">发送</a> </span></div> </div> </div> ';var n=document.createElement("div");n.innerHTML=i;document.body.appendChild(n);!function(){var e=$(".__ch");nui.util.drop($(".__c"),".__cc");var t=new nui.chat({box:e});var i=["见到你很高兴！",'本站导航：<a class="" href="../na" target="_blank">主页</a>、<a class="" href="temple/api.html" target="_blank">文档</a>'],n=0,a=setInterval(function(){var e=i[n];e?(t.send({text:e}),n++):clearInterval(a)},500);var r=$(".nui-textarea");var o=function(e){switch(!0){case e.indexOf("首页")!==-1:case e.indexOf("home")!==-1:nui.alert("跳转中...");setTimeout(function(){location.href="/na"},800);break;case e.indexOf("下载")!==-1:t.send({type:"zip",text:"resource/nui."+nui.v+".zip",me:!0});break;case e.indexOf("api")!==-1:case e.indexOf("API")!==-1:nui.alert("跳转中...");setTimeout(function(){location.href="temple/api.html"},800);break;default:nui.debounce(function(){t.send({text:e,me:!0});nui.http("https://bird.ioliu.cn/v1?url=http://www.tuling123.com/openapi/api",{key:"71d42b94bc57459a9a99017b53377579",info:e},function(e){if(e&&e.text)t.send({text:e.text})})},100)();break}};var c=(nui.store("_Chat_History_Text")||{}).text;var d=function(){var e=r.val()||"";if(""!==e.replace(/\s/g,"")){nui.store("_Chat_History_Text",{text:e});o(t.escape(e));r.val("")}};r.on("keydown",function(e){if(e.keyCode===13){return d(),false}if(e.keyCode===38&&this.value===""&&c){return this.value=c,false}});$("#submit").on("click",d);var p=$(".ing-header input");p.length?e.parent().hide():e.parent().show();p.on("change",function(){e.parent().show();o(t.escape(this.value));this.value=""})}()}})();