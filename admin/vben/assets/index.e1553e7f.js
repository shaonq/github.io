var K=Object.defineProperty,Q=Object.defineProperties;var U=Object.getOwnPropertyDescriptors;var B=Object.getOwnPropertySymbols;var Y=Object.prototype.hasOwnProperty,tt=Object.prototype.propertyIsEnumerable;var j=(e,a,u)=>a in e?K(e,a,{enumerable:!0,configurable:!0,writable:!0,value:u}):e[a]=u,y=(e,a)=>{for(var u in a||(a={}))Y.call(a,u)&&j(e,u,a[u]);if(B)for(var u of B(a))tt.call(a,u)&&j(e,u,a[u]);return e},C=(e,a)=>Q(e,U(a));import{c as X,a as z,w as A,v as M,cO as et,f as T,a7 as Z,L as nt,n as p,i as f,cA as F,dT as it,f6 as st,b9 as H,az as ot,f7 as L,aF as q}from"./index.f3af519a.js";const{t:V}=X(),G={value:{type:Boolean,default:!1},isSlot:{type:Boolean,default:!1},text:{type:[String],default:V("component.verify.dragText")},successText:{type:[String],default:V("component.verify.successText")},height:{type:[Number,String],default:40},width:{type:[Number,String],default:220},circle:{type:Boolean,default:!1},wrapStyle:{type:Object,default:{}},contentStyle:{type:Object,default:{}},barStyle:{type:Object,default:{}},actionStyle:{type:Object,default:{}}},rt=C(y({},G),{src:{type:String},imgWidth:{type:Number,default:260},imgWrapStyle:{type:Object,default:{}},minDegree:{type:Number,default:90},maxDegree:{type:Number,default:270},diffDegree:{type:Number,default:20}});var J=z({name:"BaseDargVerify",props:G,emits:["success","update:value","change","start","move","end"],setup(e,{emit:a,slots:u,expose:I}){const n=A({isMoving:!1,isPassing:!1,moveDistance:0,toLeft:!1,startTime:0,endTime:0}),i=M(null),x=M(null),S=M(null),b=M(null);et({el:document,name:"mouseup",listener:()=>{n.isMoving&&h()}});const P=T(()=>{const{height:t,actionStyle:o}=e,c=`${parseInt(t)}px`;return y({left:0,width:c,height:c},o)}),O=T(()=>{const{height:t,width:o,circle:c,wrapStyle:s}=e,l=parseInt(t),m=`${parseInt(o)}px`;return y({width:m,height:`${l}px`,lineHeight:`${l}px`,borderRadius:c?l/2+"px":0},s)}),$=T(()=>{const{height:t,circle:o,barStyle:c}=e,s=parseInt(t);return y({height:`${s}px`,borderRadius:o?s/2+"px 0 0 "+s/2+"px":0},c)}),E=T(()=>{const{height:t,width:o,contentStyle:c}=e,s=`${parseInt(t)}px`,l=`${parseInt(o)}px`;return y({height:s,width:l},c)});Z(()=>n.isPassing,t=>{if(t){const{startTime:o,endTime:c}=n,s=(c-o)/1e3;a("success",{isPassing:t,time:s.toFixed(1)}),a("update:value",t),a("change",t)}}),nt(()=>{n.isPassing=!!e.value});function D(t){return t.pageX||t.touches[0].pageX}function R(t){if(n.isPassing)return;const o=f(b);!o||(a("start",t),n.moveDistance=D(t)-parseInt(o.style.left.replace("px",""),10),n.startTime=new Date().getTime(),n.isMoving=!0)}function r(t){const o=parseInt(t.style.width),{width:c}=e,s=parseInt(c);return{offset:s-o-6,widthNum:s,actionWidth:o}}function d(t){const{isMoving:o,moveDistance:c}=n;if(o){const s=f(b),l=f(x);if(!s||!l)return;const{offset:m,widthNum:_,actionWidth:k}=r(s),v=D(t)-c;a("move",{event:t,moveDistance:c,moveX:v}),v>0&&v<=m?(s.style.left=`${v}px`,l.style.width=`${v+k/2}px`):v>m&&(s.style.left=`${_-k}px`,l.style.width=`${_-k/2}px`,e.isSlot||w())}}function g(t){const{isMoving:o,isPassing:c,moveDistance:s}=n;if(o&&!c){a("end",t);const l=f(b),m=f(x);if(!l||!m)return;const _=D(t)-s,{offset:k,widthNum:v,actionWidth:N}=r(l);_<k?e.isSlot?setTimeout(()=>{if(!e.value)h();else{const W=f(S);W&&(W.style.width=`${parseInt(m.style.width)}px`)}},0):h():(l.style.left=`${v-N}px`,m.style.width=`${v-N/2}px`,w()),n.isMoving=!1}}function w(){if(e.isSlot){h();return}n.endTime=new Date().getTime(),n.isPassing=!0,n.isMoving=!1}function h(){n.isMoving=!1,n.isPassing=!1,n.moveDistance=0,n.toLeft=!1,n.startTime=0,n.endTime=0;const t=f(b),o=f(x),c=f(S);!t||!o||!c||(n.toLeft=!0,H(()=>{n.toLeft=!1,t.style.left="0",o.style.width="0"},300),c.style.width=f(E).width)}return I({resume:h}),()=>{const t=()=>{const s=["darg-verify-bar"];return n.toLeft&&s.push("to-left"),p("div",{class:s,ref:x,style:f($)},null)},o=()=>{const s=["darg-verify-content"],{isPassing:l}=n,{text:m,successText:_}=e;return l&&s.push("success"),p("div",{class:s,ref:S,style:f(E)},[F(u,"text",l)||(l?_:m)])},c=()=>{const s=["darg-verify-action"],{toLeft:l,isPassing:m}=n;return l&&s.push("to-left"),p("div",{class:s,onMousedown:R,onTouchstart:R,style:f(P),ref:b},[F(u,"actionIcon",m)||(m?p(it,{class:"darg-verify-action__icon"},null):p(st,{class:"darg-verify-action__icon"},null))])};return p("div",{class:"darg-verify",ref:i,style:f(O),onMousemove:d,onTouchmove:d,onMouseleave:g,onMouseup:g,onTouchend:g},[t(),o(),c()])}}});var at=z({name:"ImgRotateDragVerify",inheritAttrs:!1,props:rt,emits:["success","change","update:value"],setup(e,{emit:a,attrs:u,expose:I}){const n=M(null),i=A({showTip:!1,isPassing:!1,imgStyle:{},randomRotate:0,currentRotate:0,toOrigin:!1,startTime:0,endTime:0,draged:!1}),{t:x}=X();Z(()=>i.isPassing,r=>{if(r){const{startTime:d,endTime:g}=i,w=(g-d)/1e3;a("success",{isPassing:r,time:w.toFixed(1)}),a("change",r),a("update:value",r)}});const S=T(()=>{const{imgWrapStyle:r,imgWidth:d}=e;return y({width:`${d}px`,height:`${d}px`},r)}),b=T(()=>{const{minDegree:r,maxDegree:d}=e;return r===d?Math.floor(1+Math.random()*1)/10+1:1});function P(){i.startTime=new Date().getTime()}function O(r){i.draged=!0;const{imgWidth:d,height:g,maxDegree:w}=e,{moveX:h}=r,t=Math.ceil(h/(d-parseInt(g))*w*f(b));i.currentRotate=t,i.imgStyle=L("transform",`rotateZ(${i.randomRotate-t}deg)`)}function $(){const{minDegree:r,maxDegree:d}=e,g=Math.floor(r+Math.random()*(d-r));i.randomRotate=g,i.imgStyle=L("transform",`rotateZ(${g}deg)`)}function E(){const{randomRotate:r,currentRotate:d}=i,{diffDegree:g}=e;Math.abs(r-d)>=(g||20)?(i.imgStyle=L("transform",`rotateZ(${r}deg)`),i.toOrigin=!0,H(()=>{i.toOrigin=!1,i.showTip=!0},300)):D(),i.showTip=!0}function D(){i.isPassing=!0,i.endTime=new Date().getTime()}function R(){i.showTip=!1;const r=f(n);!r||(i.isPassing=!1,r.resume(),$())}return I({resume:R}),()=>{const{src:r}=e,{toOrigin:d,isPassing:g,startTime:w,endTime:h}=i,t=[];d&&t.push("to-origin");const o=(h-w)/1e3;return p("div",{class:"ir-dv"},[p("div",{class:"ir-dv-img__wrap",style:f(S)},[p("img",{src:r,onLoad:$,width:parseInt(e.width),class:t,style:i.imgStyle,onClick:()=>{R()},alt:"verify"},null),i.showTip&&p("span",{class:["ir-dv-img__tip",i.isPassing?"success":"error"]},[i.isPassing?x("component.verify.time",{time:o.toFixed(1)}):x("component.verify.error")]),!i.showTip&&!i.draged&&p("span",{class:["ir-dv-img__tip","normal"]},[x("component.verify.redoTip")])]),p(J,ot({class:"ir-dv-drag__bar",onMove:O,onEnd:E,onStart:P,ref:n},y(y({},u),e),{value:g,isSlot:!0}),null)])}}});const dt=q(J),ft=q(at);export{dt as B,ft as R};
